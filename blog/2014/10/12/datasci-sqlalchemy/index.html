<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Why Data Scientists Should Use an ORM Like SQLAlchemy</title>
  <meta name="author" content="Dan Weitzenfeld">



  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="http://danielweitzenfeld.github.io/passtheroc/favicon.png" rel="icon">
  <link href="http://danielweitzenfeld.github.io/passtheroc/theme/css/main.css" media="screen, projection"
        rel="stylesheet" type="text/css">
  <script src="http://danielweitzenfeld.github.io/passtheroc/theme/js/modernizr-2.0.js"></script>
  <script src="http://danielweitzenfeld.github.io/passtheroc/theme/js/ender.js"></script>
  <script src="http://danielweitzenfeld.github.io/passtheroc/theme/js/octopress.js" type="text/javascript"></script>

  <link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="http://danielweitzenfeld.github.io/passtheroc/">passtheroc</a></h1>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
</ul>



<ul class="main-navigation">
</ul></nav>
  <div id="main">
    <div id="content">
<div>
  <article class="hentry" role="article">
<header>
      <h1 class="entry-title">Why Data Scientists Should Use an ORM Like SQLAlchemy</h1>
      <p class="meta"><time datetime="2014-10-12T10:20:00-04:00" pubdate>Oct 12, 2014</time></p>
</header>

  <div class="entry-content"><style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #3E424D;
}
.ansi-black-bg {
  background-color: #3E424D;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #E75C58;
}
.ansi-red-bg {
  background-color: #E75C58;
}
.ansi-red-intense-fg {
  color: #B22B31;
}
.ansi-red-intense-bg {
  background-color: #B22B31;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #DDB62B;
}
.ansi-yellow-bg {
  background-color: #DDB62B;
}
.ansi-yellow-intense-fg {
  color: #B27D12;
}
.ansi-yellow-intense-bg {
  background-color: #B27D12;
}
.ansi-blue-fg {
  color: #208FFB;
}
.ansi-blue-bg {
  background-color: #208FFB;
}
.ansi-blue-intense-fg {
  color: #0065CA;
}
.ansi-blue-intense-bg {
  background-color: #0065CA;
}
.ansi-magenta-fg {
  color: #D160C4;
}
.ansi-magenta-bg {
  background-color: #D160C4;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #60C6C8;
}
.ansi-cyan-bg {
  background-color: #60C6C8;
}
.ansi-cyan-intense-fg {
  color: #258F8F;
}
.ansi-cyan-intense-bg {
  background-color: #258F8F;
}
.ansi-white-fg {
  color: #C5C1B4;
}
.ansi-white-bg {
  background-color: #C5C1B4;
}
.ansi-white-intense-fg {
  color: #A1A6B2;
}
.ansi-white-intense-bg {
  background-color: #A1A6B2;
}
.ansi-default-inverse-fg {
  color: #FFFFFF;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #42A5F5;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #66BB6A;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph > img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}





.rendered_html pre,




.rendered_html tr,
.rendered_html th,


.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,


.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] 
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">pre { line-height: 125%; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this post, I'm going to advocate for data scientists using an ORM like the one in SQLAlchemy.  But I should start with a disclaimer about my experience, because the case I'm going to make isn't going to be relevant to everyone.  My experience is at small startups, where I was responsible for working on a wide variety of tasks, and where I had to pull and clean data myself.  If you work at a larger company, with a team of data engineers whose job it is to provide you with clean datasets, this post will be less relevant.  Also, I came to data science from a background in statistics; if you have a compsci or a programming background, this may be old hat to you.</p>
<p>In this post, I'm assuming you're familiar with SQL, but I assume no familiarity with ORMs or SQLAlchemy. In fact, let's start with a quick intro to SQLAlchemy.</p>
<h3 id="ORM:-Object-Relational-Mapper">ORM: Object Relational Mapper<a class="anchor-link" href="#ORM:-Object-Relational-Mapper">&#182;</a></h3><p>I like this definition from <a href="http://guides.rubyonrails.org/active_record_basics.html">Active Record</a>, a popular ORM for Ruby on Rails:</p>
<blockquote><p>Object-Relational Mapping, commonly referred to as its abbreviation ORM, is a technique that connects the rich objects of an application to tables in a relational database management system. Using ORM, the properties and relationships of the objects in an application can be easily stored and retrieved from a database without writing SQL statements directly and with less overall database access code.</p>
</blockquote>
<p>In short:  an ORM lets you work with objects, obviating the need to write raw SQL.</p>
<h3 id="SQLAlchemy-contains-a-Python-ORM">SQLAlchemy contains a Python ORM<a class="anchor-link" href="#SQLAlchemy-contains-a-Python-ORM">&#182;</a></h3><p>SQLAlchemy contains a Python ORM (object relational mapper) for SQL databases. I recommend looking at the <a href="http://docs.sqlalchemy.org/en/rel_0_9/orm/tutorial.html#">tutorial</a>, but here's the idea in a nutshell.  We can create classes that map to database tables:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Member</span><span class="p">(</span><span class="n">MssqlBase</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;MemberFacts&quot;</span>
    <span class="n">__table_args__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;autoload&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;autoload_with&#39;</span><span class="p">:</span> <span class="n">mssql</span><span class="o">.</span><span class="n">engine</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here, the class <code>Member</code> maps to the table <code>MemberFacts</code>.  <code>'autoload': True</code> tells SQLAlchemy to load information about the table, so it 'knows' that columns in the table and any relationships with other tables.  Here's an example of how I might use this class to query for a subset of members:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">members</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Member</span><span class="p">)</span><span class="o">.</span> \
            <span class="nb">filter</span><span class="p">(</span><span class="n">Member</span><span class="o">.</span><span class="n">created_at</span> <span class="o">&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span> \
            <span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Even if you knew nothing about SQLAlchemy, you could probably get the gist of what's happening here:  I'm querying for members created after 1/1/2014, and taking the first 10.  Behind the scenes, SQLAlchemy will take this statement, translate it into raw sql, run the sql, and translate the results back into instances of the Member class.  Each of these instances has the columns of the MemberFacts table as attributes, so if I wanted to create a pandas dataframe, I could do something like this:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="k">def</span> <span class="nf">data_frame</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">columns</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes a sqlalchemy query and a list of columns, returns a dataframe.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">make_row</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">c</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">])</span>       
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">make_row</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">query</span><span class="p">])</span>

<span class="n">query</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Member</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Member</span><span class="o">.</span><span class="n">created_at</span> <span class="o">&gt;</span> 
                                     <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># dataframe with just two fields</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">data_frame</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;created_at&#39;</span><span class="p">])</span>

<span class="c1"># dataframe with all fields in the table</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">data_frame</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">Member</span><span class="o">.</span><span class="n">__table__</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So if we're going to end up with a dataframe anyway, why take this detour through the ORM?  To answer that question, we first have to get acquainted with SQLAlchemy's <a href="http://docs.sqlalchemy.org/en/rel_0_7/orm/extensions/hybrid.html">'hybrid attributes'</a>.</p>
<h3 id="Hybrid-Attributes">Hybrid Attributes<a class="anchor-link" href="#Hybrid-Attributes">&#182;</a></h3><p>Using hybrid attributes, we can add attributes to our classes that aren't directly linked to columns in the underlying table.  Here, I'm defining the attribute 'reference_count', the number of references a job candidate has linked to this profile:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">CandidateProfile</span><span class="p">(</span><span class="n">MysqlBase</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;candidate_profile&quot;</span>
    <span class="n">__table_args__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;autoload&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;autoload_with&#39;</span><span class="p">:</span> <span class="n">mysql</span><span class="o">.</span><span class="n">engine</span><span class="p">}</span>
    <span class="n">references</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="n">CandidateReference</span><span class="p">,</span> <span class="n">backref</span><span class="o">=</span><span class="s1">&#39;candidate_profile&#39;</span><span class="p">)</span>
    
    <span class="nd">@hybrid_property</span>
    <span class="k">def</span> <span class="nf">reference_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">([</span><span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">references</span><span class="p">])</span>

    <span class="nd">@reference_count</span><span class="o">.</span><span class="n">expression</span>
    <span class="k">def</span> <span class="nf">reference_count</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">select</span><span class="p">([</span><span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">CandidateReference</span><span class="o">.</span><span class="n">profile_id</span><span class="p">)])</span><span class="o">.</span> \
            <span class="n">where</span><span class="p">(</span><span class="n">CandidateReference</span><span class="o">.</span><span class="n">profile_id</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span> \
            <span class="n">label</span><span class="p">(</span><span class="s1">&#39;reference_count&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note the two definitions of <code>reference_count</code>: the first defines the behavior at the instance level, and is 'pure' python; the second defines behavior at the class level, and uses SQLAlchemy syntax.  It's this double definition that makes these properties 'hybrid' properties.  Using the first definition, if <code>foo</code> is an instance of <code>CandidateProfile</code>, I can use <code>foo.reference_count</code> to get the number of references linked to this profile.  Using the second definition, I can query by reference count:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">candidate_profiles_with_3_references</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">CandidateProfile</span><span class="p">)</span><span class="o">.</span> \
                                       <span class="nb">filter</span><span class="p">(</span><span class="n">CandidateProfile</span><span class="o">.</span><span class="n">reference_count</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I've snuck in another concept here: note that this property relies on a relationship between CandidateProfile and CandidateReference.  While I've told SQLAlchemy how I want to refer to this relationship (as the attribute <code>references</code>), I didn't have to explicitly describe how to make the join between the two tables because SQLAlchemy figured that out when it autoloaded information about the table from the database.</p>
<p>Now we're finally ready for the two main reasons why an ORM is valuable for data scientists:</p>
<ul>
<li>hybrid properties can enforce consistent feature definitions, and</li>
<li>hybrid properties make complex feature definition easy.  </li>
</ul>
<h3 id="Hybrid-Properties-Can-Enforce-Consistent-Definitions-Across-a-Team">Hybrid Properties Can Enforce Consistent Definitions Across a Team<a class="anchor-link" href="#Hybrid-Properties-Can-Enforce-Consistent-Definitions-Across-a-Team">&#182;</a></h3><p>Databases are messy. Maybe you have demo accounts in your database, created by people you work with.  Maybe a change in the application means that accounts created before a certain date have special status and don't need to buy a subscription.</p>
<p>This creates a challenge for a data science team because not accounting for one of these countless quirks could derail an analysis.  If (for example) you are building a predictive model of subscription, and you don't know that users with a cryptic value in an arcane column on the users table will never subscribe, you're going to have a bad time.  My first thought when an analysis or model produces counter-intuitive results is to double- and triple- check the dataset, a process that can be time consuming, especially when it involves looking at raw SQL queries.</p>
<p>Hybrid properties address this problem by making it possible to standardize the definitions of complex concepts like 'this user is capable of subscribing.'  <strong>Because the definition is in one place, and in version control, the whole team is on the same page.</strong>  Take a look at this actual example from a recent project, in which I'm defining whether a Member <code>is_legit</code>.  (This is an admittedly vague term, and I should probably change it to <code>is_real_member</code> or <code>is_not_test_account</code>.)  As you can see, there were 4 different ways in which a member could be not legit:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Member</span><span class="p">(</span><span class="n">MssqlBase</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;MemberFacts&quot;</span>
    <span class="n">__table_args__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;autoload&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;autoload_with&#39;</span><span class="p">:</span> <span class="n">mssql</span><span class="o">.</span><span class="n">engine</span><span class="p">}</span>
    
    <span class="nd">@hybrid_property</span>
    <span class="k">def</span> <span class="nf">is_legit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AffinionId</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">wilbur</span><span class="o">.</span><span class="n">FAKE_AFFINIONIDS</span><span class="p">)</span> <span class="o">&amp;</span> \
               <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">date_created_dt</span> <span class="o">&lt;=</span> <span class="n">apptime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span> <span class="o">&amp;</span> \
               <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">affinion_code</span><span class="o">.</span><span class="n">ReferrenceCode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">wilbur</span><span class="o">.</span><span class="n">IGNOREABLE_CODES</span><span class="p">)</span> <span class="o">&amp;</span> \
               <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">affinion_status</span><span class="o">.</span><span class="n">RenewalDate</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2099</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="nd">@is_legit</span><span class="o">.</span><span class="n">expression</span>
    <span class="k">def</span> <span class="nf">is_legit</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">and_</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">AffinionId</span><span class="o">.</span><span class="n">notin_</span><span class="p">(</span><span class="n">wilbur</span><span class="o">.</span><span class="n">FAKE_AFFINIONIDS</span><span class="p">),</span>
                    <span class="bp">cls</span><span class="o">.</span><span class="n">date_created_dt</span> <span class="o">&lt;=</span> <span class="n">apptime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
                    <span class="bp">cls</span><span class="o">.</span><span class="n">reference_code</span><span class="o">.</span><span class="n">notin_</span><span class="p">(</span><span class="n">wilbur</span><span class="o">.</span><span class="n">IGNOREABLE_CODES</span><span class="p">),</span>
                    <span class="bp">cls</span><span class="o">.</span><span class="n">renewal_date</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2099</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the above example, <code>wilbur</code> is the name of the module for the project, and I've defined concepts like <code>FAKE_AFFINIONIDS</code> and <code>IGNOREABLE_REFCODES</code> at the module level.</p>
<p>Here's an example from a different project, in which I define a concept at the class level.  Again, it illustrates how an ORM lets you define a concept once and use it across your analyses:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">School</span><span class="p">(</span><span class="n">PsqlBase</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;schools&quot;</span>
    <span class="n">__table_args__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;autoload&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;autoload_with&#39;</span><span class="p">:</span> <span class="n">psql</span><span class="o">.</span><span class="n">engine</span><span class="p">}</span>
    
    <span class="n">ONLINE_SCHOOLS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3402</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">22673</span><span class="p">,</span> <span class="mi">4095</span><span class="p">,</span> <span class="mi">3731</span><span class="p">]</span>

    <span class="nd">@hybrid_property</span>
    <span class="k">def</span> <span class="nf">is_online</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ONLINE_SCHOOLS</span>

    <span class="nd">@is_online</span><span class="o">.</span><span class="n">expression</span>
    <span class="k">def</span> <span class="nf">is_online</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">in_</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">ONLINE_SCHOOLS</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In both of these cases, you can imagine the value of having these concepts defined in a single place, with everyone on a team using the same definition: it will cut down on questions like, 'did you exclude this set of users?'  and 'how did you define online schools?'</p>
<p>Now, the second reason and ORM is valuable for data scientists:</p>
<h3 id="Hybrid-Attributes-Make-Complex-Feature-Generation-Easy">Hybrid Attributes Make Complex Feature Generation Easy<a class="anchor-link" href="#Hybrid-Attributes-Make-Complex-Feature-Generation-Easy">&#182;</a></h3><p>In my experience, data science is 70% data munging and 40% feature generation. Using an ORM can obviate the former and make the latter easier.</p>
<p>Let's say I'm working on a project and I want a dummy variable for whether or not a user bookmarked an art school because I think users interested in art schools are less likely to use certain paid features on our site. But because of the way our database is architected, making the connection between a user and the type of school she bookmarked requires three joins. Before I started using SQLAlchemy, there were three ways I may have approached this problem:</p>
<ol>
<li>Write a complicated query every time I want to use the dummy variable, with either a <a href="http://en.wikipedia.org/wiki/Correlated_subquery">correlated subquery</a> or a <code>SUM(IF..))</code> with a <code>GROUP BY</code>, being careful that I keep my dataset at the user level</li>
<li>Write a set of simple queries, pulling the various tables, and doing the munging client-side with pandas</li>
<li>Work with a data architect/engineer to add this feature to the users table in the data warehouse</li>
</ol>
<p>None of these solutions is ideal.  1. and 2. are fast, but are filled with opportunities to make a mistake, and create code that is unpleasant to read.  3. is best from an organizational perspective: if the feature is in the warehouse, everyone on the team can use it, and maintaining accurate data in the warehouse is the engineer/architect's specialty.  If we end up using the feature a lot, I would recommend going with 3.  But if we aren't sure yet how much we'll use the feature, or if our data engineer is busy with more pressing problems, it would be nice to have another option.</p>
<p>That's where the ORM comes in.  Because the ORM 'understands' the relationship between tables, it makes coding this three-join feature easy and readable.  This example is from an actual project I worked on, and the code I used for the feature is below.  The join is from User to UserSchool to School to SchoolIPEDS:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">PsqlBase</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;users&quot;</span>
    <span class="n">__table_args__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;autoload&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;autoload_with&#39;</span><span class="p">:</span> <span class="n">psql</span><span class="o">.</span><span class="n">engine</span><span class="p">}</span>
    <span class="n">schools</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="s1">&#39;UserSchool&#39;</span><span class="p">,</span> <span class="n">backref</span><span class="o">=</span><span class="s1">&#39;user&#39;</span><span class="p">)</span>
    
    <span class="nd">@hybrid_property</span>
    <span class="k">def</span> <span class="nf">bookmarked_schools</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">schools</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">is_bookmarked</span><span class="p">]</span>
    
    <span class="nd">@hybrid_property</span>
    <span class="k">def</span> <span class="nf">bookmarked_art_school</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">art_schools</span> <span class="o">=</span> <span class="p">[</span><span class="n">bs</span> <span class="k">for</span> <span class="n">bs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bookmarked_schools</span> <span class="k">if</span> 
                       <span class="n">bs</span><span class="o">.</span><span class="n">school</span><span class="o">.</span><span class="n">ipeds_data</span><span class="o">.</span><span class="n">is_art_school</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">art_schools</span> <span class="k">else</span> <span class="kc">False</span>
    
<span class="k">class</span> <span class="nc">UserSchool</span><span class="p">(</span><span class="n">PsqlBase</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;user_schools&quot;</span>
    <span class="n">__table_args__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;autoload&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;autoload_with&#39;</span><span class="p">:</span> <span class="n">psql</span><span class="o">.</span><span class="n">engine</span><span class="p">}</span>
    <span class="n">school</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="n">School</span><span class="p">,</span> <span class="n">backref</span><span class="o">=</span><span class="s1">&#39;user_school&#39;</span><span class="p">)</span>
    
<span class="k">class</span> <span class="nc">School</span><span class="p">(</span><span class="n">PsqlBase</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;schools&quot;</span>
    <span class="n">__table_args__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;autoload&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;autoload_with&#39;</span><span class="p">:</span> <span class="n">psql</span><span class="o">.</span><span class="n">engine</span><span class="p">}</span>
    <span class="n">ipeds_data</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="s2">&quot;SchoolIPEDS&quot;</span><span class="p">,</span> <span class="n">backref</span><span class="o">=</span><span class="s1">&#39;school&#39;</span><span class="p">,</span> <span class="n">uselist</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
<span class="k">class</span> <span class="nc">SchoolIPEDS</span><span class="p">(</span><span class="n">PsqlBase</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;school_ipeds&quot;</span>
    <span class="n">__table_args__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;autoload&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;autoload_with&#39;</span><span class="p">:</span> <span class="n">psql</span><span class="o">.</span><span class="n">engine</span><span class="p">}</span>
    
    <span class="nd">@hybrid_property</span>
    <span class="k">def</span> <span class="nf">is_art_school</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ccbasic</span> <span class="o">==</span> <span class="mi">30</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(Note that I haven't defined the class-level behavior for some of these properties - that's ok as long as I don't try to use them to filter queries.)</p>
<h3 id="Secondary-Benefits">Secondary Benefits<a class="anchor-link" href="#Secondary-Benefits">&#182;</a></h3><p>These remaining benefits are nothing to sneeze at, but I'm calling them 'secondary' because they're less data-science centric.</p>
<h4 id="Expressive-and-Readable-Code">Expressive and Readable Code<a class="anchor-link" href="#Expressive-and-Readable-Code">&#182;</a></h4><p>Two years ago, I was a complete rube when it came to code readability.  I came from a background in statistics, I had only worked at tiny startups, and I had not worked closely with any developers.  When I joined howaboutwe and the developers talked about 'expressive' code, I thought they meant 'expressive' as in 'expressive of self,' and I mentally labelled them hipsters.  Sorry guys, I was wrong.</p>
<p>So in case you're where I was two years ago: the experience of reading code should be like the experience of reading prose.  It shouldn't take more than a couple read-throughs for someone <em>other than the writer</em> to fully comprehend what the code does.</p>
<p>SQLAlchemy helps in this regard by turning this:</p>

<pre><code>SELECT *
FROM MemberFacts MF
  LEFT JOIN AffinionCode AC ON MF.affinion_code = AC.code
  LEFT JOIN AffinionMembershipStatus AMS ON MF.rtid = AMS.rtid
WHERE AffinionId NOT IN ('AffinionDiagnostic','AF3')
AND   MF.created_at &lt; '2014-10-01'
AND   AC.ReferrenceCode NOT IN ('refCode1')
AND   AMS.RenewalDate &lt; '2099-01-01';

</code></pre>
<p>into this:</p>

<pre><code>members = session.query(Member).filter(Member.is_legit).all()


</code></pre>
<p>It's clear that the SQLAlchemy version is more pleasant to read and makes it easier to understand the coder's intent.  Maintaining code readability may seem like an onerous chore, but you will thank yourself when you have to read your own code two months later.  I've found that despite the intention going in, very few analyses actually are one-offs: you <em>will</em> be going back to your code at some point in the future.</p>
<h4 id="Unit-Tests">Unit Tests<a class="anchor-link" href="#Unit-Tests">&#182;</a></h4><p>Similar to code readability, unit tests are a staple of software development, but are a foreign concept to many data scientists.  In short: using an ORM like SQLAlchemy makes it possible to write tests of your feature definitions, ensuring they are measuring what you want them to measure.</p>
<h4 id="Database-Agnosticism">Database Agnosticism<a class="anchor-link" href="#Database-Agnosticism">&#182;</a></h4><p>SQLAlchemy supports PostgreSQL, MySQL, Microsoft SQL Server, Oracle, and SQLLite.  Each of these databases uses a slightly different dialect of SQL.  For example, MySQL supports the <a href="http://dev.mysql.com/doc/refman/5.5/en/control-flow-functions.html#function_if"><code>IF</code></a> function, while at least two of the others (PostgreSQL and SQL Server) don't (they use a <code>CASE</code> instead).  Should your company decide to switch backends, making a few changes in your SQLAlchemy mappings and hybrid property definitions will be much easier than combing through all your queries and make line edits.  Many changes will be handled by SQLAlchemy itself: should your company make the curious decision to switch from MySQL to SQL Server, you wouldn't have to make any changes to this expression:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">members</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Member</span><span class="p">)</span><span class="o">.</span>\
                  <span class="nb">filter</span><span class="p">(</span><span class="n">Member</span><span class="o">.</span><span class="n">created_at</span> <span class="o">&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span> \
                  <span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>... even though SQL Server <a href="http://stackoverflow.com/questions/971964/limit-10-20-in-sql-server">doesn't support limit</a>. SQLAlchemy will make the correct translation for you, once you tell it about the change in backends.</p>
<h4 id="Analogs-in-Looker">Analogs in Looker<a class="anchor-link" href="#Analogs-in-Looker">&#182;</a></h4><p>One last perk of getting familiar with data modeling in an ORM is that your hybrid properties can be translated into BI tools like the cool new kid on the block, Looker. For example, here's a property I've defined in SQLAlchemy:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Subscription</span><span class="p">(</span><span class="n">MssqlBase</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;Subscriptions&quot;</span>
    <span class="n">__table_args__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;autoload&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;autoload_with&#39;</span><span class="p">:</span> <span class="n">mssql</span><span class="o">.</span><span class="n">engine</span><span class="p">}</span>
    
    <span class="nd">@hybrid_property</span>
    <span class="k">def</span> <span class="nf">had_free_trial</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trial_began</span> <span class="n">date</span> <span class="k">else</span> <span class="mi">0</span>
    
    <span class="nd">@had_free_trial</span><span class="o">.</span><span class="n">expression</span>
    <span class="k">def</span> <span class="nf">had_free_trial</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">case</span><span class="p">([(</span><span class="bp">cls</span><span class="o">.</span><span class="n">trial_began</span> <span class="o">==</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">else_</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">Float</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And here's the corresponding property in LookML, Looker's modeling language:</p>

<pre><code>- view: subscriptions
  sql_table_name: Subscriptions
  fields:

  - dimension: had_free_trial
    type: int
    sql: CAST(CASE WHEN ${TABLE}.trial_began_date is not null THEN 1 ELSE 0 END AS FLOAT)

</code></pre>
<p>Very similar, just using a different syntax.  But the core concepts of data modeling are the same, so when you learn one, you're learning the other.</p>
<hr>
<p>That's it for now.  Hopefully, I've convinced you to consider using an ORM if you don't use one already.  I may write a future post with tips for bootstrapping your way up the SQLAlchemy learning curve.</p>

</div>
</div>
</div>
 


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
</div>
    <footer>
<p class="meta">
  <span class="byline author vcard">
    Posted by <span class="fn">Me</span>
  </span>
<time datetime="2014-10-12T10:20:00-04:00" pubdate>Oct 12, 2014</time>  <span class="categories">
    <a class="category" href="http://danielweitzenfeld.github.io/passtheroc/tag/python.html">python</a>
    <a class="category" href="http://danielweitzenfeld.github.io/passtheroc/tag/sqlalchemy.html">sqlalchemy</a>
    <a class="category" href="http://danielweitzenfeld.github.io/passtheroc/tag/datasci-in-practice.html">datasci-in-practice</a>
  </span>
</p><div class="sharing">
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://danielweitzenfeld.github.io/passtheroc/blog/2014/10/12/datasci-sqlalchemy/" data-via="weitzenfeld" data-counturl="http://danielweitzenfeld.github.io/passtheroc/blog/2014/10/12/datasci-sqlalchemy/" >Tweet</a>
</div>    </footer>
  </article>

</div>
<aside class="sidebar">
  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="http://danielweitzenfeld.github.io/passtheroc/blog/2019/09/23/xg_sitch/">Accounting for Game Situation When Using xG to Evaluate Team Strength</a>
      </li>
      <li class="post">
          <a href="http://danielweitzenfeld.github.io/passtheroc/blog/2015/01/30/bayes-nfl/">A Hierarchical Bayesian Drive-Survival Model of the NFL</a>
      </li>
      <li class="post">
          <a href="http://danielweitzenfeld.github.io/passtheroc/blog/2015/01/19/s-b-g/">Using MCMC to Fit the Shifted-Beta-Geometric Customer Lifetime Value Model</a>
      </li>
      <li class="post">
          <a href="http://danielweitzenfeld.github.io/passtheroc/blog/2014/10/28/bayes-premier-league/">A Hierarchical Bayesian Model of the Premier League</a>
      </li>
      <li class="post">
          <a href="http://danielweitzenfeld.github.io/passtheroc/blog/2014/10/12/datasci-sqlalchemy/">Why Data Scientists Should Use an ORM Like SQLAlchemy</a>
      </li>
    </ul>
  </section>
  <section>
      
    <h1>Categories</h1>
    <ul id="recent_posts">
        <li><a href="http://danielweitzenfeld.github.io/passtheroc/category/misc.html">misc</a></li>
        <li><a href="http://danielweitzenfeld.github.io/passtheroc/category/sports.html">sports</a></li>
    </ul>
  </section>
 

  <section>
  <h1>Tags</h1>
    <a href="http://danielweitzenfeld.github.io/passtheroc/tag/python.html">python</a>,    <a href="http://danielweitzenfeld.github.io/passtheroc/tag/bayesian.html">bayesian</a>,    <a href="http://danielweitzenfeld.github.io/passtheroc/tag/mcmc.html">mcmc</a>,    <a href="http://danielweitzenfeld.github.io/passtheroc/tag/pymc.html">pymc</a>,    <a href="http://danielweitzenfeld.github.io/passtheroc/tag/ltv.html">LTV</a>,    <a href="http://danielweitzenfeld.github.io/passtheroc/tag/sqlalchemy.html">sqlalchemy</a>,    <a href="http://danielweitzenfeld.github.io/passtheroc/tag/datasci-in-practice.html">datasci-in-practice</a>,    <a href="http://danielweitzenfeld.github.io/passtheroc/tag/pelican.html">pelican</a>  </section>



<section>
    <a href="http://twitter.com/weitzenfeld" class="twitter-follow-button" data-show-count="true">Follow @weitzenfeld</a>
</section>
</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
    Copyright &copy;  2014-2019  - Dan Weitzenfeld -
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-55540014-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-55540014-1');
    ga('send', 'pageview');
</script>
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>
</body>
</html>